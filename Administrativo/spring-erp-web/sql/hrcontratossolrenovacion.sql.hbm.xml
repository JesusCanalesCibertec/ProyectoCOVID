<?xml version="1.0" encoding="UTF-8"?>
<!-- * * @author : desarrollo * @powerbuilder : rrhh.HrContratos-->
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

  <sql-query name="hrcontratossolrenovacion.obtenerMetadata">
    	<![CDATA[	 select A.EMPLEADO,
       A.SECUENCIA,               -- Secuencia
       A.COMPANIASOCIO,
       A.SECUENCIASOLICITUD,
       A.FECHASOLICITUD,

       A.SOLICITANTE,
       A.FLAGRENOVAR,
       A.TIPOCONTRATO,
       A.TIEMPORENOVACION,
       A.MOTIVORENOVACION,

       A.MOTIVONORENOVACION,
       A.SUSTENTO,
       A.CODIGOPROCESO,
       A.NUMEROPROCESO,
       UPPER(LTRIM(RTRIM(N.DESCRIPCION))) AS TIPOCONTRATO_DESC,

       UPPER(LTRIM(RTRIM(O.DESCRIPCIONLOCAL))) AS TIEMPORENOVACION_DESC,
       P.NOMBRECOMPLETO AS SOLICITANTE_DESC,
       cast(B.CODIGOUNIDAD as varchar(10)),
       B.CENTROCOSTOS,
       B.TIPOPLANILLA,

       B.SUCURSAL, 
       B.UNIDADOPERATIVA,
       B.CODIGOPUESTO,
       cast(B.CARGO as varchar(10)),
       cast (B.GRADOSALARIAL as varchar(	10)),

       D.NOMBRECOMPLETO AS EMPLEADO_DESC,
       UPPER(LTRIM(RTRIM(E.DESCRIPTION))) AS COMPANIA_DESC,
       UPPER(LTRIM(RTRIM(F.DESCRIPCION))) AS UNIDADORGANIGRAMA_DESC,
       UPPER(LTRIM(RTRIM(G.LOCALNAME))) AS CENTROCOSTOS_DESC,
       UPPER(LTRIM(RTRIM(H.DESCRIPCION))) AS TIPOPLANILLA_DESC,

       UPPER(LTRIM(RTRIM(I.DESCRIPCIONLOCAL))) AS SUCURSAL_DESC,  
       UPPER(LTRIM(RTRIM(J.DESCRIPCION))) AS UNIDADOPERATIVA_DESC,
       UPPER(LTRIM(RTRIM(K.DESCRIPCION))) AS PUESTO_DESC,
       UPPER(LTRIM(RTRIM(L.DESCRIPCIONLOCAL))) AS CATEGORIA_DESC,  -- Categoria Funcional
       UPPER(LTRIM(RTRIM(M.DESCRIPCIONLOCAL))) AS GRADOSALARIO_DESC,

       D.NOMBRECOMPLETO AS NOMBRECOMPLETO,
       B.FECHADESDE,
       B.FECHAHASTA,
       CASE A.ESTADO WHEN 'A' THEN 'APROBADO' WHEN 'S' THEN 'SOLICITADO' END ESTADO
FROM
              HR_CONTRATOS_SOLRENOVACION A
       JOIN HR_CONTRATOS B ON A.EMPLEADO = B.EMPLEADO AND A.SECUENCIA = B.SECUENCIA AND A.COMPANIASOCIO = B.COMPANIASOCIO
       JOIN EMPLEADOMAST C ON A.EMPLEADO = C.EMPLEADO AND A.COMPANIASOCIO = C.COMPANIASOCIO
       JOIN PERSONAMAST D ON A.EMPLEADO = D.PERSONA
       JOIN COMPANYOWNER E ON B.COMPANIASOCIO = E.COMPANYOWNER
       LEFT JOIN HR_POSICIONEMPRESA F ON C.CODIGOUNIDAD = F.CODIGOPOSICION AND C.COMPANIASOCIO = F.COMPANYOWNER
       LEFT JOIN AC_COSTCENTERMST G ON C.CENTROCOSTOS = G.COSTCENTER
       LEFT JOIN PR_TIPOPLANILLA H ON C.TIPOPLANILLA = H.TIPOPLANILLA
       LEFT JOIN AC_SUCURSAL I ON C.SUCURSAL = I.SUCURSAL
       LEFT JOIN HR_UNIDADOPERATIVA J ON C.UNIDADOPERATIVA = J.UNIDADOPERATIVA
       LEFT JOIN HR_PUESTOEMPRESA K ON C.CodigoCargo = K.CODIGOPUESTO
       LEFT JOIN HR_CARGOSMAST L ON C.CARGO = L.CARGO
       LEFT JOIN HR_GRADOSALARIOMAST M ON C.GradoSalario = M.GRADOSALARIO
       LEFT JOIN HR_TIPOCONTRATO N ON A.TIPOCONTRATO = N.TIPOCONTRATO
       LEFT JOIN MA_MISCELANEOSDETALLE O ON O.APLICACIONCODIGO = 'HR' AND O.COMPANIA = '999999' AND O.CODIGOTABLA = 'TIEMRENOVA'
             AND A.TIEMPORENOVACION = O.CODIGOELEMENTO
       JOIN PERSONAMAST P ON A.SOLICITANTE = P.PERSONA
WHERE
       A.NUMEROPROCESO = :p_numero ]]>
  </sql-query>

</hibernate-mapping>
