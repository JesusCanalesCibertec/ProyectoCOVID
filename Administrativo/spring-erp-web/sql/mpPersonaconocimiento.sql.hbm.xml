<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

  <sql-query name="mpPersonaconocimiento.listarconocimientos">
      
	SELECT
	T2.NOMBRE,
	MA.DESCRIPCIONLOCAL AS 'NIVEL',
	MA1.DESCRIPCIONLOCAL aS 'Tipo',
	case T2.TIPO
			when 'T' then MA2.DESCRIPCIONLOCAL 
			else MA3.DESCRIPCIONLOCAL
			END as '√Årea',
	T1.ID_CONOCIMIENTO
	FROM minedu.PERSONA_CONOCIMIENTO T1
	LEFT JOIN minedu.CONOCIMIENTO T2 ON T1.ID_CONOCIMIENTO = T2.ID_CONOCIMIENTO
	LEFT JOIN MA_MISCELANEOSDETALLE MA ON T1.NIVEL = MA.CODIGOELEMENTO AND MA.CODIGOTABLA = 'NIVELCON' AND MA.APLICACIONCODIGO = 'MP'
	LEFT JOIN MA_MISCELANEOSDETALLE MA1 ON T2.TIPO = MA1.CODIGOELEMENTO AND MA1.CODIGOTABLA = 'TIPOCON' AND MA1.COMPANIA = '000200' AND MA1.ESTADO = 'A'
			LEFT JOIN MA_MISCELANEOSDETALLE MA2 ON T2.AREA = MA2.CODIGOELEMENTO AND MA2.CODIGOTABLA = 'AREATCON' AND MA2.COMPANIA = '000200' AND MA2.ESTADO = 'A'
			LEFT JOIN MA_MISCELANEOSDETALLE MA3 ON T2.AREA = MA3.CODIGOELEMENTO AND MA3.CODIGOTABLA = 'AREAMCON' AND MA3.COMPANIA = '000200' AND MA3.ESTADO = 'A'
	WHERE T1.ID_PERSONA = ISNULL(:p_idpersona,T1.ID_PERSONA)
	order by 3,1
		

	</sql-query>


</hibernate-mapping>
